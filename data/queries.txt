LOAD EMPLOYEE
LOAD PROJECT
LOAD WORKS_ON
LOAD DEPARTMENT
Q1TEMP <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM Q1TEMP
Q2temp1 <- CROSS EMPLOYEE EMPLOYEE
Q2temp2 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM Q2temp1
Q2temp3 <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM Q2temp2
Q2 <- PROJECT EMPLOYEE1_Ssn , EMPLOYEE1_Super_ssn , EMPLOYEE1_Bdate FROM Q2temp3
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE1_Super_ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2
Q3_C <- CROSS EMPLOYEE WORKS_ON
Q3_V <- SELECT Ssn == Essn FROM Q3_C
Q3_P <- PROJECT Sex,Pno FROM Q3_V
Q3_M <- SELECT Sex == 0 FROM Q3_P
Q3_F <- SELECT Sex == 1 FROM Q3_P
Q3_MF_P <- CROSS Q3_F Q3_M
Q3_Temp <- SELECT Q3_F_Pno == Q3_M_Pno FROM Q3_MF_P
Q3 <- PROJECT Q3_F_Pno FROM Q3_Temp
RENAME Q3_F_Pno TO Pno FROM Q3
Q4t1 <- CROSS EMPLOYEE WORKS_ON
Q4temp1 <- SELECT Ssn == Essn FROM Q4t1
Q4t2 <- CROSS EMPLOYEE WORKS_ON
Q4temp2 <- SELECT Ssn == Essn FROM Q4t2
Q4temp3 <- CROSS Q4temp1 Q4temp2
Q4temp4 <- SELECT Q4temp1_Super_ssn == Q4temp2_Ssn FROM Q4temp3
Q4temp5 <- SELECT Q4temp1_Pno == Q4temp2_Pno FROM Q4temp4
Q4 <- PROJECT Q4temp1_Ssn , Q4temp2_Ssn , Q4temp1_Pno FROM Q4temp5
RENAME Q4temp1_Ssn TO Ssn FROM Q4
RENAME Q4temp2_Ssn TO Super_ssn FROM Q4
RENAME Q4temp1_Pno TO Pno FROM Q4
EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
QUIT
